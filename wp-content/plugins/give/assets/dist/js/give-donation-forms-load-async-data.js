document.addEventListener("DOMContentLoaded",(function(){var e=!1,t=!1,n=document.querySelector(".giveListTable"),o=new Event("giveListTableIsLoading");function i(e){var t=e.getBoundingClientRect(),n=t.top,o=t.bottom,i=window.innerHeight||document.documentElement.clientHeight;return(n>0||o>0)&&n<i}function a(e){return!!e&&Boolean(e.querySelector(".js-give-async-data"))}var r=function(o,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;if(a(r)||a(d)||a(u))if(window.GiveDonationFormsAsyncData.throttlingEnabled&&e)window.GiveDonationFormsAsyncData.scriptDebug&&console.log("throttleTimer start: ",e);else{e=!0,window.GiveDonationFormsAsyncData.scriptDebug&&console.log("request start: ",(new Date).toLocaleTimeString()),window.GiveDonationFormsAsyncData.scriptDebug&&console.log("item: ",i),i.classList.add("give-async-data-fetch-triggered");var g=new AbortController,v=g.signal;fetch("".concat(window.GiveDonationFormsAsyncData.ajaxUrl,"?action=givewp_get_form_async_data_for_list_view&formId=").concat(o,"&nonce=").concat(window.GiveDonationFormsAsyncData.ajaxNonce),{signal:v}).then((function(e){return e.json()})).then((function(e){window.GiveDonationFormsAsyncData.scriptDebug&&console.log("Response: ",e),e.success&&(a(r)&&(r.innerHTML=e.data.amountRaised),s&&s.style.width!==e.data.percentComplete+"%"&&(s.style.width=e.data.percentComplete+"%"),l&&e.data.percentComplete>=100&&(l.style.opacity="1"),a(d)&&(d.innerHTML=e.data.donationsCount),a(u)&&(u.innerHTML=e.data.revenue))})).catch((function(e){i.classList.remove("give-async-data-fetch-triggered"),window.GiveDonationFormsAsyncData.scriptDebug&&console.log("Error: ",e)})).finally((function(){window.GiveDonationFormsAsyncData.scriptDebug&&console.log("request end: ",(new Date).toLocaleTimeString()),window.GiveDonationFormsAsyncData.throttlingEnabled&&e&&(e=!1,window.GiveDonationFormsAsyncData.scriptDebug&&console.log("throttleTimer end: ",e),c()),window.GiveDonationFormsAsyncData.scriptDebug&&console.log("Request finalized.")})),addEventListener("beforeunload",(function(e){t=!0,g.abort("Async request aborted due to exit page.")})),n&&n.addEventListener("giveListTableIsLoading",(function(e){t=!0,g.abort("Async request aborted due to table loading.")}))}},c=function(){var e,n,o;t?window.GiveDonationFormsAsyncData.scriptDebug&&console.log("abortLoadAsyncData"):((e=document.querySelectorAll("tr:not(.give-async-data-fetch-triggered)")).length>0&&(s(),e.forEach((function(e){var t=e.querySelector(".giveListTableSelect");if(t){var n=t.getAttribute("data-id"),o=e.querySelector("[id^='giveDonationFormsProgressBar'] > span"),a=e.querySelector(".goalProgress > span"),c=e.querySelector(".goalProgress--achieved"),s=e.querySelector(".column-donations-count-value"),l=e.querySelector(".column-earnings-value");i(e)&&r(n,e,o,a,c,s,l)}}))),(n=document.querySelectorAll(".type-give_forms:not(.give-async-data-fetch-triggered)")).length>0&&n.forEach((function(e){if(e.hasAttribute("id")&&e.id.includes("post-")){var t=e.id.split("post-")[1],n=e.querySelector(".column-goal"),o=n.querySelector(".give-goal-text > span"),a=n.querySelector(".give-admin-progress-bar > span"),c=n.querySelector(".give-admin-goal-achieved"),s=e.querySelector(".column-donations > a"),l=e.querySelector(".column-earnings > a");i(e)&&r(t,e,o,a,c,s,l)}})),(o=document.querySelectorAll(".give-grid__item:not(.give-async-data-fetch-triggered)")).length>0&&o.forEach((function(e){var t=e.querySelector(".give-card");if(t&&t.hasAttribute("id")&&t.id.includes("give-card-")){var n=t.id.split("give-card-")[1],o=e.querySelector(".form-grid-raised");if(o){var a=o.querySelector("div:nth-child(1)").querySelector("span:nth-child(1)"),c=e.querySelector(".give-progress-bar").querySelector("span"),s=o.querySelector("div:nth-child(2)").querySelector("span:nth-child(1)");i(e)&&r(n,e,a,c,null,s)}}})))};function s(){n&&new MutationObserver((function(e){n.classList.contains("giveListTableIsLoading")&&n.dispatchEvent(o),n.classList.contains("giveListTableIsLoaded")&&(t=!1,c())})).observe(n,{attributes:!0,childList:!1,characterData:!1})}c(),window.addEventListener("scroll",(function(){c()}),!0),window.addEventListener("resize",(function(){c()}),!0),window.onload=function(){var e=document.querySelector(".wp-block-post-content");e&&new ResizeObserver((function(e){window.GiveDonationFormsAsyncData.scriptDebug&&console.log("WP Block Editor height changed:",e[0].target.clientHeight),c()})).observe(e)}}));